\ProvidesPackage{latex-bfs-matrix}[2021/03/27 v1.0 Implementation of a 2D matrix data structure using macros]
\RequirePackage{etoolbox}
\newcounter{lbfsqu@m@x}\newcounter{lbfsqu@m@y}
% Note: for bitmap, unblocked fields are not defined


% name | width | height
\def\CreateMatrix#1#2#3{%
\ifcsname lbfsqu@ds@matrix@#1@w\endcsname
    \PackageError{The Matrix '#1' does already exist.}\fi
\expandafter\edef\csname lbfsqu@ds@matrix@#1@w\endcsname{#2}%
\expandafter\edef\csname lbfsqu@ds@matrix@#1@h\endcsname{#3}%
\c@lbfsqu@m@y0\relax
}

\def\GetMatrixWidth#1{\csname lbfsqu@ds@matrix@#1@w\endcsname}
\def\GetMatrixHeight#1{\csname lbfsqu@ds@matrix@#1@h\endcsname}
\def\GetMatrix#1(#2,#3){\csname lbfsqu@ds@matrix@#1@#2@#3\endcsname}
\def\CurMatrixX{\number\c@lbfsqu@m@x}
\def\CurMatrixY{\number\c@lbfsqu@m@y}
\def\SetMatrix#1(#2,#3)#4{\expandafter\def\csname lbfsqu@ds@matrix@#1@#2@#3\endcsname{#4}}

\def\ResetMatrix#1{%
\MatrixForY{#1}{\MatrixForX{#1}{%
    \expandafter\undef\csname lbfsqu@ds@matrix@#1@\number\c@lbfsqu@m@x @\number\c@lbfsqu@m@y\endcsname%
}}}

\newcommand\MatrixForX[3][0]{%
\c@lbfsqu@m@x#1\relax
\@whilenum\c@lbfsqu@m@x<\csname lbfsqu@ds@matrix@#2@w\endcsname\do{\relax#3\advance\c@lbfsqu@m@x\@ne}%
}

\newcommand\MatrixForY[3][0]{%
\c@lbfsqu@m@y#1\relax
\@whilenum\c@lbfsqu@m@y<\csname lbfsqu@ds@matrix@#2@h\endcsname\do{\relax#3\advance\c@lbfsqu@m@y\@ne}%
}

% BitMap-Specific
\def\lbfsqu@m@@blocked{1}
\def\BlockMatrix#1(#2,#3){\expandafter\let\csname lbfsqu@ds@matrix@#1@#2@#3\endcsname\lbfsqu@m@@blocked}


\def\IfMatrixBlocked#1(#2,#3)#4#5{\ifcsname lbfsqu@ds@matrix@#1@#2@#3\endcsname#4\else#5\fi}


\endinput